---
import DocsLayout from "./DocInfoLayout.astro";
import InfoBox from "../components/InfoBox.astro";
import { languages } from "../data/languages";
import { getTextColorForBackground } from "../utils/utils";

/**
 * Defines the essential configuration properties required to render the landing page.
 * It captures the target language name to fetch data, a brief introductory description, and specific color hex codes to dynamically theme UI elements like buttons and highlights.
 */
interface Props {
	language: string;
	description: string;
	color: string;
	colorDark: string;
}

const { language, description, color, colorDark } = Astro.props;

const btnTextColor = getTextColorForBackground(color);

/**
 * Retrieves the specific language metadata by traversing the categorized data structure.
 * It searches through all categories to find the item matching the provided title prop.
 */
const langInfo = languages
	.flatMap((lang) => lang.items)
	.find((item) => item.title === language);

const installLink = `/${language.toLowerCase()}/installation-guide`;
---

<DocsLayout title={language}>
	<div class="landing-container">
		<h1 class="title"><span class="text-highlight">{language}</span> Notes</h1>
		<p class="intro">{description}</p>

		<InfoBox
			difficulty={langInfo?.difficulty}
			prerequisites={langInfo?.prerequisites}
		/>

		<hr class="divider" />

		<section>
			<h2>Key Concepts</h2>
			<ul class="topic-list">
				{
					/* Index will be used in doc-layout.css for calculing the delay time in its animation */
					langInfo?.concepts.map((concept, index) => (
						<li style={`--i: ${index}`}>
							<a href={concept.href}>
								<h3>{concept.title}</h3>
								<p>{concept.desc}</p>
							</a>
						</li>
					))
				}
			</ul>
		</section>

		<hr class="divider" />

		<section class="install-section">
			<div class="cta-container">
				<h2>Ready to start building?</h2>
				<p>Follow the complete setup process in our dedicated guide.</p>

				<a
					href={installLink}
					class="install-btn"
					title={`See ${language}'s installation guide`}
				>
					Installation Guide <span>&rarr;</span>
				</a>
			</div>
		</section>
	</div>
</DocsLayout>

<style
	define:vars={{
		themeColor: color,
		themeColorDark: colorDark,
		themeTextColor: btnTextColor,
	}}
>
	/* 
    Utilizes Astro's define:vars directive to pass server-side JavaScript variables into the CSS scope. 
    This creates dynamic CSS custom properties based on the props. 
  */

	.text-highlight {
		color: var(--themeColor);
	}

	.topic-list a:hover {
		border-color: var(--themeColor);
	}

	.install-btn {
		background-color: var(--themeColor);
		color: var(--themeTextColor);
	}

	.install-btn:hover {
		background-color: var(--themeColorDark);
	}
</style>
